(function(e){var t={top:0,bottom:10};var n={$nav:null,targets:{},current:null,paused:false,inBounds:false,max:null,min:null,_init:function(r){n.$nav=this;e.extend(t,r);n.$nav.find("[data-spy-on]").each(function(){n.targets["#"+e(this).attr("id")]={}});n._setBounds();return n.$nav},_setMinMax:function(e,t){if(e<n.min||n.min==null){n.min=e}if(t>n.max||n.max==null){n.max=t}},_setBounds:function(){for(var r in n.targets){var i=e(r).data("spy-on"),s=Math.floor(e(i).offset().top-t.top),o=Math.floor(s+e(i).outerHeight()-t.bottom);n.targets[r]={top:s,bottom:o};n._setMinMax(s,o)}},_scrollCheck:function(e){if(e<n.min||e>n.max){n.current&&n.exit();n.current&&n.deactivate(n.current)}else{!n.inBounds&&n.enter();for(var t in n.targets){var r=n.targets[t].top,i=n.targets[t].bottom;if(r<=e&&e<=i&&n.current!==t){n.current&&n.deactivate(n.current);n.activate(t)}}}},deactivate:function(t){n.$nav.trigger("ns.deactivate",e(t));n.$nav.find(".active").removeClass("active");n.current=null},activate:function(t){n.$nav.trigger("ns.activate",e(t));e(t).addClass("active");n.current=t},enter:function(){n.inBounds=true;n.$nav.trigger("ns.enter")},exit:function(){n.inBounds=false;n.$nav.trigger("ns.exit")},pause:function(){n.paused=true},unpause:function(){n.paused=false;n._scrollCheck(e(window).scrollTop())}};e.fn.navspy=function(){e(window).bind("scroll",function(){if(!n.paused){n._scrollCheck(e(window).scrollTop())}});e(window).bind("resize",function(){n._setBounds()});if(n[arguments[0]]){return n[arguments[0]].call(this,Array.prototype.slice.call(arguments,1))}else if(typeof arguments[0]==="object"||!arguments){return n._init.call(this,arguments[0])}else{e.error("Unknown method called")}}})(jQuery)