(function(e){var t={top:0,bottom:10};var n={$nav:null,targets:{},current:null,paused:false,max:null,min:null,init:function(r){n.$nav=this;e.extend(t,r);n.$nav.find("[data-spy-on]").each(function(){n.targets["#"+e(this).attr("id")]={}});n._setBounds();return n.$nav},_setMinMax:function(e,t){if(e<n.min||n.min==null){n.min=e}if(t>n.max||n.max==null){n.max=t}},_setBounds:function(){for(var r in n.targets){var i=e(r).data("spy-on"),s=Math.floor(e(i).offset().top-t.top),o=Math.floor(s+e(i).outerHeight()-t.bottom);n.targets[r]={top:s,bottom:o};n._setMinMax(s,o)}},scrollCheck:function(e){if(e<n.min||e>n.max){n.deactivate(n.current)}else{for(var t in n.targets){var r=n.targets[t].top,i=n.targets[t].bottom;if(r<=e&&e<=i&&n.current!==t){n.current&&n.deactivate(n.current);n.activate(t)}}}},deactivate:function(t){n.$nav.trigger("deactivate",e(t));e(t).removeClass("active");n.current=null},activate:function(t){n.$nav.trigger("activate",e(t));e(t).addClass("active");n.current=t},pause:function(){n.paused=true},unpause:function(){n.paused=false;n.scrollCheck(e(window).scrollTop())}};e.fn.navspy=function(t){e(window).bind("scroll",function(){if(!n.paused){n.scrollCheck(e(window).scrollTop())}});e(window).bind("resize",function(){n._setBounds()});if(n[t]){return n[t].apply(this,Array.prototype.slice.call(t,1))}else if(typeof t==="object"||!t){return n.init.call(this,t)}else{e.error("Unknown method called")}}})(jQuery)